\documentclass[english,notitlepage,reprint,nofootinbib]{revtex4-1}  % defines the basic parameters of the document
% For preview: skriv i terminal: latexmk -pdf -pvc filnavn
% If you want a single-column, remove "reprint"
% Allows special characters (including æøå)
\usepackage[utf8]{inputenc}
% \usepackage[english]{babel}

%% Note that you may need to download some of these packages manually, it depends on your setup.
%% I recommend downloading TeXMaker, because it includes a large library of the most common packages.

\usepackage{physics,amssymb}  % mathematical symbols (physics imports amsmath)
\include{amsmath}
\usepackage{graphicx}         % include graphics such as plots
\usepackage{xcolor}           % set colors
\usepackage{hyperref}         % automagic cross-referencing
\usepackage{listings}         % display code
%\usepackage{subfigure}        % imports a lot of cool and useful figure commands
\usepackage{float}
%\usepackage[section]{placeins}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{subfigure}
\usepackage{tikz}
\usepackage{mathrsfs}
\bibliographystyle{apsrev4-1}
\usetikzlibrary{quantikz}
% defines the color of hyperref objects
% Blending two colors:  blue!80!black  =  80% blue and 20% black
\hypersetup{ % this is just my personal choice, feel free to change things
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}}
% ===========================================


\begin{document}

\title{A study of phase transition in the 2D Ising model\\using Markov Chain Monte Carlo simulation}  % self-explanatory
\author{Alessio Canclini, Filip von der Lippe} % self-explanatory
\date{\today}                             % self-explanatory
\noaffiliation                            % ignore this, but keep it.



\begin{table}
    \centering
    \caption{Time used for different number of threads in parallelization at temperature level. A quad-core, 8 thread CPU has been used for the ising model initialized with a $5\times5$ lattice with randomized initial spins and temperature $T= 1$ $J/k_B$}
    \label{tab:timing}
    \begin{tabular}{|c|c|c|c|}
        \hline
        Number of threads & 1     & 4    & 8    \\
        \hline
        Time used (s)     & 29.12 & 8.42 & 7.32 \\
        \hline
        speed-up factor   & 1     & 3.45 & 3.92 \\
        \hline
    \end{tabular}
\end{table}
In table  we see that parallelizing our code can reduce computation time a factor of 0.25 using 8 threads for an 8 thread CPU. We also see that a 4 thread parallelization performs well with a speed-up factor of 3.45.
% ===========================================

From our timing test using parallelization at temperature level we saw a great reduction in computation time when using more threads with a speed-up factor of 3.92 going from utilizing 1 to 8 threads. For an 8 thread CPU we would expect the speed-up factor being closer to 8, which shows that the physical core count of the processor influences the speed-up factor. In our case of a quad-core CPU we saw that even 4 threaded parallelization got close to the 8 thread performance. In total this means that the expected speed-up factor using a processor's all threads would be closer to its physical core and not thread count. On the other hand, we do not know how parallelization at the level of the Markov Chain Monte Carlo method would influence the speed-up time. Such a parallelization may see better performance than our time level parallelization overall as well as better scaling when using more threads. This would require further investigation.



\begin{table}
    \centering
    \caption{Critical temperature as a function of lattice size computed using both $\chi$ and $C_v$.}
    \label{tab:critical_T}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
        Lattice sizes      & 40    & 60    & 80    & 100   \\
        \hline
        $T_C$ using $C_v$  & 2.287 & 2.284 & 2.274 & 2.271 \\
        \hline
        $T_C$ using $\chi$ & 2.310 & 2.300 & 2.301 & 2.284 \\
        \hline
    \end{tabular}
\end{table}

MARKOV CHAIN MONTE CARLO
A Markov Chain is a stochastic model

METROPOLIS
We start with an initial energy computed from the random or odered inital configuration of spins. We randomly flip one spin and calculate a temporary energy which we use to calculate $\Delta E$ which can take 5 different values. This gives us the possibility to use the returned value as an index which matches with the pre-calculated $w= e^{-\beta \Delta E}$. We then check if $w$ is larger or equal some random number in the interval [0,1] and if so, we accept the new flipped configuration. If not we keep the old configuration which allows us to move towards the energy minimum for the given temperature. We update the total energy and magnetization of the lattice if the configuration is changed. We perform this over and over $N$ times before parameters $E$ and $M$



Å GJØRE:
periodic boundary inn i optimalization

Hakkete: he Monte Carlo method will repeatedly require the
Boltzmann factor e−β∆E . The energy shift induced by
flipping a single spin....

compare numerical analytical

burn in time resultater - hva ser vi for ordered

varians i histogram for T=1 er mye mindre samtidig som den ser mye mer ekstreme verdier Ser verdier helt opp til -0.8 - større intervall enn for T=2.4

diskusjon - begrunnelse for at 10 i sjette er valgt og ikke høyere eller lavere.

diskusjon - mindre temperatursteg samtidig som bruk av flere lattice sizes.
The equations introduced in the methods-section are presented in a somewhat awkward way. You should write the text in a coherent manner, with the equations as part of this.

Many quantities are given without units.